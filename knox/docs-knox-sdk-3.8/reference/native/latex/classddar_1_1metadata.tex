\hypertarget{classddar_1_1metadata}{\section{ddar\-:\-:metadata \-Class \-Reference}
\label{classddar_1_1metadata}\index{ddar\-::metadata@{ddar\-::metadata}}
}


\-Metadata provides key-\/value paired persistent cache and chunk of volatile memory connected to a file.  




{\ttfamily \#include $<$ddar.\-h$>$}

\subsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
virtual int \hyperlink{classddar_1_1metadata_a27dc324990551ef738296190d66b79ad}{persistent\-\_\-set} (const char $\ast$name, const void $\ast$value, int size)=0
\begin{DoxyCompactList}\small\item\em \-Set persistent cache entry. \end{DoxyCompactList}\item 
virtual int \hyperlink{classddar_1_1metadata_a2e4c99aa26e5f111a910d20297905bcf}{persistent\-\_\-get} (const char $\ast$name, void $\ast$value)=0
\begin{DoxyCompactList}\small\item\em \-Get persistent cache entry. \end{DoxyCompactList}\item 
\hypertarget{classddar_1_1metadata_ad42a2a17a192112e60871e3d7f8a3b65}{virtual unsigned long \hyperlink{classddar_1_1metadata_ad42a2a17a192112e60871e3d7f8a3b65}{get\-\_\-inode} ()=0}\label{classddar_1_1metadata_ad42a2a17a192112e60871e3d7f8a3b65}

\begin{DoxyCompactList}\small\item\em \-Returns inode number of the file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{\-Public \-Attributes}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \hyperlink{classddar_1_1metadata_adae2c43de47db6d2c97d59231e6e7d0f}{ephemeral\-\_\-addr}
\begin{DoxyCompactList}\small\item\em \-Ephemeral cache memory chunk. \end{DoxyCompactList}\item 
\hypertarget{classddar_1_1metadata_aa8bb4d26891dc1128725bd004c6e9a2a}{int \hyperlink{classddar_1_1metadata_aa8bb4d26891dc1128725bd004c6e9a2a}{ephemeral\-\_\-size}}\label{classddar_1_1metadata_aa8bb4d26891dc1128725bd004c6e9a2a}

\begin{DoxyCompactList}\small\item\em \-Size of ephemeral cache memory chunk. \end{DoxyCompactList}\item 
\hypertarget{classddar_1_1metadata_a4c1add585adf08e05d862f4e6b801560}{\hyperlink{classddar_1_1context}{context} $\ast$ \hyperlink{classddar_1_1metadata_a4c1add585adf08e05d862f4e6b801560}{context}}\label{classddar_1_1metadata_a4c1add585adf08e05d862f4e6b801560}

\begin{DoxyCompactList}\small\item\em \-Holds \hyperlink{classddar_1_1context}{ddar\-::context} object associated to the file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{\-Static \-Public \-Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classddar_1_1metadata_a05546ee6284ed1a7ad24f6c7d2d2ba55}{static constexpr const int {\bfseries \-M\-A\-X\-\_\-\-P\-E\-R\-S\-I\-S\-T\-E\-N\-T\-\_\-\-C\-A\-C\-H\-E\-\_\-\-N\-A\-M\-E\-\_\-\-L\-E\-N} = 32}\label{classddar_1_1metadata_a05546ee6284ed1a7ad24f6c7d2d2ba55}

\item 
\hypertarget{classddar_1_1metadata_afcfa157acf61b2b0ff17b07f2efe0c80}{static constexpr const int {\bfseries \-M\-A\-X\-\_\-\-P\-E\-R\-S\-I\-S\-T\-E\-N\-T\-\_\-\-C\-A\-C\-H\-E\-\_\-\-V\-A\-L\-U\-E\-\_\-\-L\-E\-N} = 128}\label{classddar_1_1metadata_afcfa157acf61b2b0ff17b07f2efe0c80}

\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Metadata provides key-\/value paired persistent cache and chunk of volatile memory connected to a file. 

\-Metadata objects are always on the stack, hence no need locking and valid only during following crypto functions\-: \begin{DoxySeeAlso}{\-See also}
bool \hyperlink{classddar_1_1abstract__crypto_a1f1a4d550c0840b4e04bc6d6129a0f13}{abstract\-\_\-crypto\-::prepare(context $\ast$context, metadata $\ast$md)} 

bool \hyperlink{classddar_1_1abstract__crypto_a17eef7aebf0ef97684af036b657a9947}{abstract\-\_\-crypto\-::encrypt(metadata $\ast$md, void $\ast$pt, void $\ast$ct, unsigned long page\-\_\-offset, int page\-\_\-len)} 

bool \hyperlink{classddar_1_1abstract__crypto_aaaf5ca9de70bf1b902cecc72049653b8}{abstract\-\_\-crypto\-::decrypt(metadata $\ast$md, void $\ast$ct, unsigned long page\-\_\-offset, int page\-\_\-len)}
\end{DoxySeeAlso}
\-Persistent cache -\/ \-Store key-\/value pairs in persistent memory associated with a file. \-The crypto plug-\/in shall store key derivation materials to use later to generate \-F\-E\-K(file encryption key) and also other attributes; such as version info, domain and etc,..

\-Ephemeral cache -\/ \-Provides cache in kernel space memory and mmap()ed to the user space address region during crypto operation. \-The main objective is to avoid storing sensitive information (e.\-g., \-F\-E\-K) into a persistent memory either user space program has to derive \-F\-E\-K every time before crypto operation. \-Ephemeral cache is allocated in the kernel, it will be zeroed out in data-\/lock state together with other sensitive materials associated with the file (e.\-g., ext4 inode eviction invalidates \-O\-E\-M encryption key) 

\subsection{\-Member \-Function \-Documentation}
\hypertarget{classddar_1_1metadata_a2e4c99aa26e5f111a910d20297905bcf}{\index{ddar\-::metadata@{ddar\-::metadata}!persistent\-\_\-get@{persistent\-\_\-get}}
\index{persistent\-\_\-get@{persistent\-\_\-get}!ddar::metadata@{ddar\-::metadata}}
\subsubsection[{persistent\-\_\-get}]{\setlength{\rightskip}{0pt plus 5cm}virtual int {\bf ddar\-::metadata\-::persistent\-\_\-get} (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{void $\ast$}]{value}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}pure virtual\mbox{]}}}}\label{classddar_1_1metadata_a2e4c99aa26e5f111a910d20297905bcf}


\-Get persistent cache entry. 

\-Errors\-: $\sim$$\sim$$\sim$ \-E\-N\-O\-D\-A\-T\-A \-The named entry does not exist \-E\-N\-O\-T\-S\-U\-P \-Persistent storage is not supported by the file system $\sim$$\sim$$\sim$ \begin{DoxyReturn}{\-Returns}
\-On success, return a nonnegative value which is the size of value. \-On failure, -\/1 is returned 
\end{DoxyReturn}
\hypertarget{classddar_1_1metadata_a27dc324990551ef738296190d66b79ad}{\index{ddar\-::metadata@{ddar\-::metadata}!persistent\-\_\-set@{persistent\-\_\-set}}
\index{persistent\-\_\-set@{persistent\-\_\-set}!ddar::metadata@{ddar\-::metadata}}
\subsubsection[{persistent\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}virtual int {\bf ddar\-::metadata\-::persistent\-\_\-set} (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{const void $\ast$}]{value, }
\item[{int}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}pure virtual\mbox{]}}}}\label{classddar_1_1metadata_a27dc324990551ef738296190d66b79ad}


\-Set persistent cache entry. 

\-Errors\-: $\sim$$\sim$$\sim$ \-E\-N\-O\-S\-P\-C \-There is insufficient space remaining to store new entry \-E\-N\-O\-T\-S\-U\-P \-Persistent storage is not supported by the file system $\sim$$\sim$$\sim$ \begin{DoxyReturn}{\-Returns}
\-On success, zero is returned. \-On failure, -\/1 is returned 
\end{DoxyReturn}


\subsection{\-Member \-Data \-Documentation}
\hypertarget{classddar_1_1metadata_adae2c43de47db6d2c97d59231e6e7d0f}{\index{ddar\-::metadata@{ddar\-::metadata}!ephemeral\-\_\-addr@{ephemeral\-\_\-addr}}
\index{ephemeral\-\_\-addr@{ephemeral\-\_\-addr}!ddar::metadata@{ddar\-::metadata}}
\subsubsection[{ephemeral\-\_\-addr}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ {\bf ddar\-::metadata\-::ephemeral\-\_\-addr}}}\label{classddar_1_1metadata_adae2c43de47db6d2c97d59231e6e7d0f}


\-Ephemeral cache memory chunk. 

ephemeral\-\_\-addr is only valid within crypto function scope (prepare, encrypt, decrypt) caller should not keep the address and use it later 

\-The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
dualdar/ddar.\-h\end{DoxyCompactItemize}
